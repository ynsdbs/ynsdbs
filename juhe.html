<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Title</title>
  <script type="text/javascript">
    //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    //步骤1：替换数据
    var lnglats=`

1 王连生,97.896794,23.983685,第一轮
2 貌丁林索,97.897244,23.98726,第一轮
3 梁礼贤,97.900589,23.983302,第一轮
4 杜琴丹伍,97.896745,23.983422,第一轮
5 昂吞磊,97.897293,23.987272,第一轮
6 梦丁,97.897275,23.98726,第一轮
7 特苗吞,97.897186,23.987285,第一轮
8 吉漂达,97.897244,23.98726,第一轮
9 也门,97.897141,23.987359,第二轮
10 徐博韬,97.900666,23.983261,第二轮
11 吴谬明,97.896885,23.987446,第二轮
12 玛卫,97.897204,23.987041,第二轮
13 吞路,97.894221,23.988903,第二轮
14 貌代本伍,97.896607,23.983331,第二轮
15 貌凯明伍,97.897253,23.987376,第二轮
16 顶波,97.897298,23.987359,第二轮
17 杜莱,97.897199,23.987384,第二轮
18 杜敏敏,97.897159,23.987355,第二轮
19 行腿奥,97.897298,23.987462,第二轮
20 貌索林,97.897419,23.987446,第二轮
21 恒麻推,97.902459,23.986653,第二轮
22 龙彩华,97.897594,23.982518,第二轮
23 荷玛奥,97.897927,23.980289,第二轮
24 柳君鹏,97.900536,23.98305,第三轮
25 林龙,97.900482,23.983154,第三轮
26 貌伟漂昂,97.896391,23.987661,第三轮
27 玛朵朵五,97.900687,23.984878,第三轮
28 玛宁努努耐,97.898224,23.985153,第三轮
29 玛伦麻薇,97.898341,23.984971,第三轮
30 马伍,97.8971,23.987355,第三轮
31 卖恩静,97.897137,23.986954,第三轮
32 岩良,97.894324,23.98887,第三轮
33 梦腊,97.897477,23.987095,第三轮
34 字蓉,98.058292,24.079545,第三轮
35 貌昂谬铁,97.895734,23.979945,第四轮
36 AwngSanmin,97.897817,23.980486,第四轮
37 玛丁萨温,97.89741,23.98757第四轮
38 貌波亚,97.897789,23.9803,第四轮
39 梁晨,97.900635,23.983108,第四轮
40 貌缪明,97.897311,23.987587,第四轮
41 占喊,97.889563,23.984879,第五轮
42 李自勇,97.897558,23.987231,第五轮
43 也焕,97.89746,23.987281,第五轮
44 玛宁贝漂,97.9009,23.980715,第五轮
45 玛弟达敏,97.894694,23.983336,第五轮
46 当奈,97.894625,23.983306,第五轮
47 多亚迪,97.900512,23.984819,第五轮
48 貌索莫觉,97.900566,23.984688,第五轮
49 琴美,97.898139,23.986201,第五轮
50 杜漂特,97.896902,23.983492,第五轮
51 何光珍,98.071729,24.083298,第五轮
52 楠瑞,97.896974,23.987392,第五轮
53 梅迪达,97.898107,23.985021,第五轮
54 玛米南,97.90075,23.984853,第六轮
55 貌索温迈,97.900745,23.984766,第六轮
56 貌丹温,97.892059,23.979768,第六轮
57 管国志,97.888906,23.978184,第六轮
58 貌孟杰昂,97.895463,23.987618,第六轮
59 赵玉菲,97.894667,23.983274,第七轮
60 索南仁青,97.897546,23.984875,第七轮
61 耐耐索,97.898012,23.980318,第八轮
62 余菊玉,97.894802,23.983233,第九轮
63 左腊生,97.889158,23.978234,第十轮
64 陈春勤,98.058418,24.079331,第十轮
65 春明,97.642529,23.89858,第十一轮
66 岳管喊,97.644541,23.892831,第十二轮
67 赛帅,97.644622,23.892748,第十二轮
68 南也静,97.642547,23.898497,第十二轮
69 相也,97.642295,23.898481,第十二轮
70 左和,97.644469,23.892723,第十三轮
71 张志南,97.898569,23.983129,第十三轮
72 张星宇,97.898695,23.983154,第十三轮
73 张建军,97.898353,23.984268,第十三轮
74 岩孟,97.893808,23.97882,第十三轮
75 玛依依登,97.903312,23.983129,第十三轮

`;
    //步骤2：确定坐标系统
    var CRS=3;// 1= WGS84  2=火星坐标   3=百度坐标

    //步骤3：设置图标大小、颜色、图标中的文本及图例显示的文本/////////
    var mheight=30                          ;//设置图标高度
    var mwidth=20                           ;//设置图标宽度
    var SymCol=["red","blue","green","DeepPink","DarkMagenta","Darkorange","DarkSlateGray","Olive","SaddleBrown","Gray","Cyan","DarkMagenta","Teal"]; //设置图标颜色
    var SymLet=["A","B","C","D","E","F","G","H","I", "J", "K", "L", "M", "N", "O","P","Q","R","S", "T", "U", "V", "W","X","Y","Z"]	;//设置图标中的文字
    var Legendtxt=["第一轮","第二轮","第三轮","第四轮","第五轮","第六轮","第七轮","第八轮","第九轮","第十轮","第十一轮","第十二轮","第十三轮"]	//设置图例显示文本，按首次出现的顺序

    ////！！！！！！！！！以下部分不要修改！！！！！！！！！///////////////////////////////////////////////////////////////////////////////////////////////
    //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  </script>
  <meta charset="utf-8">
  <script type="text/javascript" src="https://webapi.amap.com/maps?v=1.4.15&key=3664b7738ba0979d33c4e58032438d29&plugin=AMap.CustomLayer,AMap.MarkerClusterer"></script>
  <script src="https://webapi.amap.com/ui/1.1/main.js?v=1.1.1"></script>
  <script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.js"></script>
    <style type="text/css">
    html, body{	width: 100%; height: 100%;border: none;margin:0; }
    #divx{position: absolute;bottom:0.5rem;right:1rem;z-index: 20;	}
    .legend {width: 200px; position: absolute; left: 10px; bottom: 50px; background-color:white; border-radius: 5px; box-shadow: 0 0 5px rgba(0, 0, 0, 0.3); }
    .legend ul {overflow: hidden;list-style: none;margin: 0;padding: 0;z-index:20}
    .legend ul li {float: left;height: 30px;width:170px;}
    .legend ul li a {float: left;color: #555; font-size: 14px; text-decoration: none; height: 30px;line-height: 30px;}
    .legend ul li span {float: left;width:14px;height: 14px; margin: 8px; }
    .namelist {width: 300px; position: absolute; right: 10px; bottom: 50px; background-color:white ; border-radius: 5px; box-shadow: 0 0 5px rgba(0, 0, 0, 0.3); }
    .namelist ul {list-style: none;margin: 0;padding: 0;z-index:20;;overflow-y:scroll;height:400px}
    .namelist ul li {height: 30px;}
  </style>
  
</head>
<body>
<div id="divmap"  style="width: 100%;height:100%" >
  <div  id="divx" >
    <label id="pp0"><input type="checkbox" class="pointckb" id="ckblab">标签</label>
    <label><input type="checkbox" class="pointckb" id="ckblist">列表</label>
    <label><input type="checkbox" class="pointckb" id="ckblegend">图例</label>
    <label><input type="checkbox" class="pointckb" id="ckbcluster">聚合图</label>
    <input type="checkbox" style="margin-left: 2em;" id="ckbarea" >
    <label  class="mapstylelab" style="font-family: 微软雅黑;">行政区划</label>
    &emsp;<input  type="button"  id="btndisplay"  value="恢复最佳显示" />
  </div>
</div>
<div class="legend" id="legend"><ul></ul></div>
<div class="namelist" id="namelist"><ul></ul></div>
<script type="text/javascript">
  ////S1 坐标转化函数///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  //定义一些常量
  var x_PI = 3.14159265358979324 * 3000.0 / 180.0;
  var PI = 3.1415926535897932384626;
  var a = 6378245.0;
  var ee = 0.00669342162296594323;
  //
  function bd09towgs84(bd_lon, bd_lat){
    var jin_gcj_value = bd09togcj02( bd_lon , bd_lat)[0]
    var wei_gcj_value = bd09togcj02( bd_lon , bd_lat)[1]
    var jin_wgs_value = gcj02towgs84(jin_gcj_value, wei_gcj_value)[0]
    var wei_wgs_value = gcj02towgs84(jin_gcj_value, wei_gcj_value)[1]
    return [jin_wgs_value, wei_wgs_value]
  };
  //
  function wgs84tobd09(wgs_lon, wgs_lat){
    var jin_gcj_value = wgs84togcj02 ( wgs_lon, wgs_lat)[0]
    var wei_gcj_value = wgs84togcj02 ( wgs_lon, wgs_lat)[1]
    var jin_bd_value  = gcj02tobd09(jin_gcj_value, wei_gcj_value)[0]
    var wei_bd_value  = gcj02tobd09(jin_gcj_value, wei_gcj_value)[1]
    return [jin_bd_value, wei_bd_value]
  };
  //
  function bd09togcj02(bd_lon, bd_lat) {
    var x_pi = 3.14159265358979324 * 3000.0 / 180.0;
    var x = bd_lon - 0.0065;
    var y = bd_lat - 0.006;
    var z = Math.sqrt(x * x + y * y) - 0.00002 * Math.sin(y * x_pi);
    var theta = Math.atan2(y, x) - 0.000003 * Math.cos(x * x_pi);
    var gg_lng = z * Math.cos(theta);
    var gg_lat = z * Math.sin(theta);
    return [gg_lng, gg_lat]
  }
  //
  function gcj02tobd09(lng, lat) {
    var z = Math.sqrt(lng * lng + lat * lat) + 0.00002 * Math.sin(lat * x_PI);
    var theta = Math.atan2(lat, lng) + 0.000003 * Math.cos(lng * x_PI);
    var bd_lng = z * Math.cos(theta) + 0.0065;
    var bd_lat = z * Math.sin(theta) + 0.006;
    return [bd_lng, bd_lat]
  }
  //
  function wgs84togcj02(lng, lat) {
    if (out_of_china(lng, lat)) {return [lng, lat]}	else {
      var dlat = transformlat(lng - 105.0, lat - 35.0);
      var dlng = transformlng(lng - 105.0, lat - 35.0);
      var radlat = lat / 180.0 * PI;
      var magic = Math.sin(radlat);
      magic = 1 - ee * magic * magic;
      var sqrtmagic = Math.sqrt(magic);
      dlat = (dlat * 180.0) / ((a * (1 - ee)) / (magic * sqrtmagic) * PI);
      dlng = (dlng * 180.0) / (a / sqrtmagic * Math.cos(radlat) * PI);
      var mglat = lat + dlat;
      var mglng = lng + dlng;
      return [mglng, mglat]
    }
  }
  //
  function gcj02towgs84(lng, lat) {
    if (out_of_china(lng, lat)) {return [lng, lat]}else {
      var dlat = transformlat(lng - 105.0, lat - 35.0);
      var dlng = transformlng(lng - 105.0, lat - 35.0);
      var radlat = lat / 180.0 * PI;
      var magic = Math.sin(radlat);
      magic = 1 - ee * magic * magic;
      var sqrtmagic = Math.sqrt(magic);
      dlat = (dlat * 180.0) / ((a * (1 - ee)) / (magic * sqrtmagic) * PI);
      dlng = (dlng * 180.0) / (a / sqrtmagic * Math.cos(radlat) * PI);
      mglat = lat + dlat;
      mglng = lng + dlng;
      return [lng * 2 - mglng, lat * 2 - mglat]
    }
  }
  //
  function transformlat(lng, lat) {
    var ret = -100.0 + 2.0 * lng + 3.0 * lat + 0.2 * lat * lat + 0.1 * lng * lat + 0.2 * Math.sqrt(Math.abs(lng));
    ret += (20.0 * Math.sin(6.0 * lng * PI) + 20.0 * Math.sin(2.0 * lng * PI)) * 2.0 / 3.0;
    ret += (20.0 * Math.sin(lat * PI) + 40.0 * Math.sin(lat / 3.0 * PI)) * 2.0 / 3.0;
    ret += (160.0 * Math.sin(lat / 12.0 * PI) + 320 * Math.sin(lat * PI / 30.0)) * 2.0 / 3.0;
    return ret
  }
  //
  function transformlng(lng, lat) {
    var ret = 300.0 + lng + 2.0 * lat + 0.1 * lng * lng + 0.1 * lng * lat + 0.1 * Math.sqrt(Math.abs(lng));
    ret += (20.0 * Math.sin(6.0 * lng * PI) + 20.0 * Math.sin(2.0 * lng * PI)) * 2.0 / 3.0;
    ret += (20.0 * Math.sin(lng * PI) + 40.0 * Math.sin(lng / 3.0 * PI)) * 2.0 / 3.0;
    ret += (150.0 * Math.sin(lng / 12.0 * PI) + 300.0 * Math.sin(lng / 30.0 * PI)) * 2.0 / 3.0;
    return ret
  }
  //
  function out_of_china(lng, lat) { return (lng < 72.004 || lng > 137.8347) || ((lat < 0.8293 || lat > 55.8271) || false);}
  ////CRS-END////////////////////////////

  //////S2 地图设置/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  //显示地图及控件
  var map = new AMap.Map('divmap', {viewMode: '2D', animateEnable:false, zoom:4,center: [105,33] });
  AMap.plugin(['AMap.ToolBar','AMap.Scale','AMap.MapType'], function(){
    map.addControl(new AMap.Scale());
    map.addControl(new AMap.MapType());
  });

  //整理数据////////////////////////////////////////////////////////////
  var points =[],ccates=[];
  var adds=lnglats.split(/[(\r\n)\r\n]+/);
  var id=0;
  for (var i = 0; i < adds.length; i++) {
    var add=adds[i];

    if(add!=""){
      id++;
      var eachplace=   add.split(",");
      var address=eachplace[0];
      var lng=eachplace[1];
      var lat=eachplace[2];
      var ccate=eachplace[3];
      if(typeof(ccate)=="undefined"){ccate=""};
      ccates.push(ccate);
      if(CRS==1){
        var lnggd=wgs84togcj02(parseFloat(lng), parseFloat(lat) )[0];
        var latgd=wgs84togcj02(parseFloat(lng), parseFloat(lat) )[1];
      }
      if(CRS==2){
        var lnggd=lng;
        var latgd=lat;
      }
      if(CRS==3){
        var lnggd=bd09togcj02(parseFloat(lng), parseFloat(lat) )[0];
        var latgd=bd09togcj02(parseFloat(lng), parseFloat(lat) )[1];
      }
      points.push({"id":id,"lnggd":lnggd,"latgd":latgd,"address":address,"ccate":ccate});
    };
  };
  //////
  console.log(points)
  /////////分类/////////////
  var sset=new Set(ccates);
  sset.delete("");
  var SymUni=[...sset];
  ////////////////////////////////////////////////////////// //////
  var labtxtscale=function(x){if(x<100) return(12);if(x>=100 && x<1000) return(9);if(x>=1000) return(5) };
  var markers=[],labelMarkers=[],SymIi=1;
  ///显示图标	///////
  var labtxtbig;
  if(ccates.length<10){labtxtbig=20}else{labtxtbig=6}
  AMapUI.loadUI(['overlay/SvgMarker'], function(SvgMarker) {
    ///////////////////////////////////////////////////////
    if(SymUni.length>0){
      ////////////////
      for(var i = 0,pointsLen = points.length;i <pointsLen;i++){
        var j=SymUni.indexOf(points[i].ccate);
        if( points[i].ccate!="" ){
          var marker = new SvgMarker(
            new SvgMarker.Shape.WaterDrop({height: mheight,width:mwidth, fillColor: SymCol[Math.min(j,SymCol.length-1 )], strokeWidth: 1,strokeColor: SymCol[Math.min(j,SymCol.length-1 )]}),
            {position: [points[i].lnggd, points[i].latgd],title: points[i].address,iconLabel:{innerHTML:'<div style="font-size:10px;text-align:center;">'+points[i].id+'</div>', style: {color:'white'}}}
          );
        }else{
          var marker = new SvgMarker(
            new SvgMarker.Shape.WaterDrop({height: mheight,width:mwidth, fillColor: 'red', strokeWidth: 1,strokeColor: 'red'}),
            {position: [points[i].lnggd, points[i].latgd],title: points[i].address,iconLabel:{innerHTML:'<div style="font-size:'+labtxtscale(SymIi)+'px;text-align:center;">'+points[i].id+'</div>', style: {color:'white'}}}
          );
          SymIi++;
        }
        markers.push(marker);
        //添加标签
        var labelMarker = new AMap.LabelMarker({
          position:[points[i].lnggd, points[i].latgd],
          text:{content: points[i].address, direction:'bottom', offset: [0, 0],style:{fontSize:13,fontWeight:'normal',fillColor:'#fff',padding:'2, 5',backgroundColor:SymCol[Math.min(j,SymCol.length-1 )]}}
        });
        labelMarkers.push(labelMarker);
      }
      /////////////////////
    }else{
      for(var i = 0,pointsLen = points.length;i <pointsLen;i++){
        var marker = new SvgMarker(
          new SvgMarker.Shape.WaterDrop({height: mheight,width:mwidth, fillColor: 'red', strokeWidth: 1,strokeColor: 'red'}),
          {position: [points[i].lnggd, points[i].latgd],title: points[i].address,iconLabel:{innerHTML:'<div style="font-size:'+labtxtscale(SymIi)+'px;text-align:center;">'+points[i].id+'</div>', style: {color:'white'}}}
        );
        SymIi++;
        markers.push(marker);
      }
      /////////////////////////
    }
    ///////////////////////////////////////////////////////////
    //
    gdlabellayer=new AMap.LabelsLayer({zooms: [3, 20],zIndex: 1000,collision: true,animation: false});
    gdlabellayer.add(labelMarkers);
    gdlabellayer.setMap(null);
    //


    var gdcluster=new AMap.MarkerClusterer(map,markers,{gridSize: 80 });
    gdcluster.setMap(null);



    map.add(markers);
    map.setFitView();
    ///////////////////////////////////////////////////////////////////////////////////////////////////////////////
    //最佳显示/////////////////////
    document.getElementById("btndisplay").onclick=function(){
      map.setFitView(markers)
    }

    ///聚合图
    var pointcluster=document.getElementById("ckbcluster");
    pointcluster.onclick=function(){
      if(pointcluster.checked){
        gdcluster.setMap(map);
      }else{gdcluster.setMap(null);
        map.add(markers);

      }
    }

//////////////////////
  });


  //显示标签/////////////////////////////
  var pointlab=document.getElementById("ckblab");
  pointlab.onclick=function(){
    if(pointlab.checked){
      gdlabellayer.setMap(map);
    }else{
      gdlabellayer.setMap(null);
    }
  }

  //显示列表////////////////////////////////////////////////////////
  var varnamelist=document.getElementById("namelist")
  varnamelist.style.display="none";//隐藏
  var ul2 = document.querySelector('.namelist ul');
  var ul2txt="<br>";
  var ccount=1;
  for(var i = 0;i <points.length;i++){
    ul2txt +='<li class="litest"><a   href="#"   class="test"   lng='+ points[i].lnggd +' lat='+        points[i].latgd      +  '  > ' + ("00"+ccount).slice(-3) + '： '+points[i].address+'</a></li>';
    ccount++;
  }
  //
  var markersel;
  var dislist=document.getElementById("ckblist");
  dislist.onclick=function(){
    if(dislist.checked){
      ul2.innerHTML=ul2txt
      varnamelist.style.display="";
      $(".test").click(function(){
        map.setCenter( [ $(this).attr("lng") , $(this).attr("lat")]     );
        if(typeof(markersel)!='undefined'){
          map.remove(markersel);
        }
        markersel =new AMap.CircleMarker({
          center: [$(this).attr("lng"), $(this).attr("lat")  ] ,
          radius:10, fillColor:'yellow', strokeColor:'red',strokeWeight:6, fillOpacity:0.5,zIndex:300
        });
        map.add(markersel);
      });
      //
      $(".litest").mouseover(function(){
        this.style.background = '#58FA58';
      });

      $(".litest").mouseleave(function(){
        this.style.background = '';
      });
      //
    }else{
      varnamelist.style.display="none";
      if(typeof(markersel)!='undefined'){
        map.remove(markersel);
      }
    }
  }



  //显示图例////////////////////////////////////////////////////////
  var ul = document.querySelector('.legend ul');
  var ultxt="";
  for(var i=0;i < sset.size; i++) {
    ultxt +='<li><span style="background: ' + SymCol[i]+ ';"></span><a> ' +SymLet[i] + '： '+ Legendtxt[i]+'</a></li>';
  }
  //
  var dislegend=document.getElementById("ckblegend");
  dislegend.onclick=function(){
    if(dislegend.checked){
      ul.innerHTML=ultxt
    }else{
      ul.innerHTML=""
    }
  }


  //////S3 添加行政区划///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
  var colors = [
    "#3366cc", "#dc3912", "#ff9900", "#109618", "#990099", "#0099c6", "#dd4477", "#66aa00", "#b82e2e", "#316395",
    "#994499", "#22aa99", "#aaaa11", "#6633cc", "#e67300", "#8b0707", "#651067", "#329262", "#5574a6", "#3b3eac"
  ];
  AMapUI.load(['ui/geo/DistrictExplorer', 'lib/$'], function(DistrictExplorer, $) {
    //////////////////////////////////////////////////////////////////////
    //鼠标hover提示内容
    var $tipMarkerContent = $('<div style="width:200px;font-size:16px;font-family: 微软雅黑;color:gray" class="tipMarker2"></div>');
    var tipMarker = new AMap.Marker({
      content: $tipMarkerContent.get(0),
      offset: new AMap.Pixel(0, 0),
      bubble: true
    });
    //根据Hover状态设置相关样式
    function toggleHoverFeature(feature, isHover, position) {
      tipMarker.setMap(isHover ? map : null);
      if (!feature) { return;   }
      var props = feature.properties;
      if (isHover) {
        $tipMarkerContent.html(props.name+'\n('+props.adcode + ')');
        tipMarker.setPosition(position || props.center);
      }
      var polys = districtExplorer.findFeaturePolygonsByAdcode(props.adcode);
      for (var i = 0, len = polys.length; i < len; i++) {polys[i].setOptions({fillOpacity: isHover ? 0.5 : 0.2});}
    }
    //绘制某个区域的边界
    function renderAreaPolygons(areaNode) {
      districtExplorer.clearFeaturePolygons();
      districtExplorer.renderSubFeatures(areaNode, function(feature, i) {
        var fillColor = colors[i % colors.length];
        var strokeColor = colors[colors.length - 1 - i % colors.length];
        return { cursor: 'default',bubble: true,strokeColor: strokeColor,strokeOpacity: 1, strokeWeight: 1, fillColor: fillColor, fillOpacity: 0.35 };
      });
      districtExplorer.renderParentFeature(areaNode, {cursor: 'default', bubble: true,strokeColor: 'black',strokeOpacity: 1, strokeWeight: 1,fillColor: areaNode.getSubFeatures().length ? null : colors[0],fillOpacity: 0.35});
    }
    //切换区域
    function switch2AreaNode(adcode, callback) {
      loadAreaNode(adcode, function(error, areaNode) {
        if (error) { if (callback) {callback(error); }; return; }
        currentAreaNode = window.currentAreaNode = areaNode;
        districtExplorer.setAreaNodesForLocating([currentAreaNode]);
        districtExplorer.setHoverFeature(null);
        renderAreaPolygons(areaNode);
        if (callback) { callback(null, areaNode);  }
      });
    }
    //加载区域
    function loadAreaNode(adcode, callback) {
      districtExplorer.loadAreaNode(adcode, function(error, areaNode) {
        if (error) {if (callback) { callback(error); }; console.error(error); return; }
        if (callback) { callback(null, areaNode); }
      });
    }
    //判断定位级别
    function  displayxzqh(positon){
      districtExplorer.locatePosition(positon, function(error, routeFeatures) {
          let gdmapzoom=map.getZoom();
          if (routeFeatures && routeFeatures.length > 1) {
            if(gdmapzoom<6) {switch2AreaNode(routeFeatures[0].properties.adcode);}
            if(gdmapzoom>=6 && gdmapzoom<8){switch2AreaNode(routeFeatures[1].properties.adcode);}
            if(gdmapzoom>=9 ){switch2AreaNode(routeFeatures[2].properties.adcode);}
          } else {
            switch2AreaNode(100000);
          }
        },
        {  levelLimit: 4 }
      );
    }

    ////////////////
    var xzqh=document.getElementById("ckbarea");
    xzqh.onclick=function(){
      if(xzqh.checked){
        districtExplorer = new DistrictExplorer({eventSupport: true,  map: map });
        districtExplorer.on('featureMouseout featureMouseover', function(e, feature) {toggleHoverFeature(feature, e.type === 'featureMouseover', e.originalEvent ? e.originalEvent.lnglat : null);});
        districtExplorer.on('featureMousemove', function(e, feature) {tipMarker.setPosition(e.originalEvent.lnglat);});
        districtExplorer.on('featureClick', function(e, feature) { var props = feature.properties;switch2AreaNode(props.adcode);   });
        districtExplorer.on('outsideClick', function(e) {displayxzqh(e.originalEvent.lnglat)  });
        displayxzqh(map.getCenter());
      }else{
        districtExplorer.clearFeaturePolygons();
        districtExplorer.destroy();
        map.remove(tipMarker);
      }
    }
    ////////////////////////////////////////////////////////////////////////////////////
  });
  ///////////////////////////////////////////////////////////////////////////////////////////////////////
</script>
</body>
</html>
